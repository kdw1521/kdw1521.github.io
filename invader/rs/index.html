<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>겹치는 이메일 찾기</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --bd:#ccd1d7; --bg:#f6f7f9; --fg:#111; }
    html,body{margin:0;padding:20px;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans KR",sans-serif}
    .wrap{max-width:960px;margin:0 auto}
    h1{margin:0 0 12px;font-size:20px}
    label{display:block;font-weight:600;margin:12px 0 8px}
    textarea{width:100%;min-height:220px;padding:12px;border:1px solid var(--bd);border-radius:12px;background:#fff;resize:vertical;line-height:1.5;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    .row{display:grid;grid-template-columns:1fr;gap:16px}
    .controls{display:flex;gap:10px;align-items:center;margin:14px 0 18px}
    button{cursor:pointer;border:0;border-radius:10px;padding:10px 16px;font-weight:700}
    .primary{background:#111;color:#fff}
    .ghost{background:#e9eef5;color:#111}
    .stats{font-size:12px;color:#666;margin-left:auto}
    /* 결과 영역은 부분 색상 강조를 위해 textarea 스타일의 div 사용 */
    .output{width:100%;min-height:160px;padding:12px;border:1px solid var(--bd);border-radius:12px;background:#fff;white-space:pre-wrap;line-height:1.6;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    .red{color:#d01717}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>겹치는 이메일 찾기</h1>

    <label for="a">결제자</label>
    <textarea id="a" placeholder="한 줄당 하나의 이메일을 붙여넣기"></textarea>

    <label for="b">신청자</label>
    <textarea id="b" placeholder="한 줄당 하나의 이메일을 붙여넣기"></textarea>

    <div class="controls">
      <button id="run" class="primary">겹치는것 찾기</button>
      <button id="clear" class="ghost">지우기</button>
      <div id="stats" class="stats"></div>
    </div>

    <label for="result">겹치는 데이터</label>
    <div id="result" class="output" aria-live="polite"></div>
  </div>

  <script>
    // 간단한 이메일 파서: 줄바꿈/쉼표 기준 분리, 불필요 문자 제거, 유효 이메일만 통과
    function parseEmails(text){
      const chunks = text.split(/[\r\n,]+/);
      const out = [];
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/i;
      for (let c of chunks){
        if (!c) continue;
        c = c.trim().replace(/[<>"'()]/g,'');
        if (c === '---' || c === '—') continue;
        if (re.test(c)) out.push(c);
      }
      return out;
    }
    const toLowerSet = arr => new Set(arr.map(v => v.toLowerCase()));
    function intersect(aSet, bSet){
      const out = new Set();
      for (const v of aSet) if (bSet.has(v)) out.add(v);
      return out;
    }

    function run(){
      const a = parseEmails(document.getElementById('a').value);
      const b = parseEmails(document.getElementById('b').value);

      const aSet = toLowerSet(a);
      const bSet = toLowerSet(b);
      const dupLower = intersect(aSet, bSet);

      // 원문 보존: 첫 등장 원문을 매핑
      const original = new Map();
      for (const e of [...a, ...b]){
        const k = e.toLowerCase();
        if (!original.has(k)) original.set(k, e);
      }
      const dups = [...dupLower].map(k => original.get(k)).sort((x,y)=>x.localeCompare(y));

      const result = document.getElementById('result');
      result.innerHTML = dups.length
        ? dups.map(e => `<span class="red">${e}</span>`).join('\n')
        : '겹치는 이메일 없음';

      document.getElementById('stats').textContent =
        `A: ${aSet.size} · B: ${bSet.size} · 겹치는 것: ${dupLower.size}`;
    }

    function clearAll(){
      document.getElementById('a').value = '';
      document.getElementById('b').value = '';
      document.getElementById('result').textContent = '';
      document.getElementById('stats').textContent = '';
    }

    document.getElementById('run').addEventListener('click', run);
    document.getElementById('clear').addEventListener('click', clearAll);
  </script>
</body>
</html>
